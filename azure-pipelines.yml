trigger:

- master

pool:
  vmImage: 'ubuntu-latest'

steps:
- task: NodeTool@0
  inputs:
    versionSpec: '10.x'
  displayName: 'Install Node.js'

- script: |
    npm install
    npm run build
  displayName: 'npm install and build'

- task: Docker@2
  inputs:
    containerRegistry: 'Docker hub - GoLogic'
    repository: 'joshuaghaligologic/concourse-multibranch'
    command: 'buildAndPush'
    Dockerfile: 'Dockerfile'
  displayName: 'Build and publish image'

- task: Npm@1
  inputs:
    command: 'publish'
    publishRegistry: 'useFeed'
    publishFeed: 'adf9280b-3287-467a-afb6-106826f0a236'
  displayName: 'Publish to NPM registry'
